POSTED ON JANUARY 27, 2026 TO
Security & Privacy

Rust at Scale: An Added Layer of Security for WhatsApp

By
Daniel Sommermann
,
Baojun Wang

WhatsApp has adopted and rolled out a new layer of security for users – built with Rust – as part of its effort to harden defenses against malware threats.

WhatsApp's experience creating and distributing our media consistency library in Rust to billions of devices and browsers proves Rust is production ready at a global scale.

Our Media Handling Strategy

WhatsApp provides default end-to-end encryption for over 3 billion people to message securely each and every day. Online security is an adversarial space, and to continue ensuring users can keep messaging securely, we're constantly adapting and evolving our strategy against cyber-security threats – all while supporting the WhatsApp infrastructure to help people connect.

For example, WhatsApp, like many other applications, allows users to share media and other types of documents. WhatsApp helps protect users by warning about dangerous attachments like APKs, yet rare and sophisticated malware could be hidden within a seemingly benign file like an image or video. These maliciously crafted files might target unpatched vulnerabilities in the operating system, libraries distributed by the operating system, or the application itself.

To help protect against such potential threads, WhatsApp is increasingly using the Rust programming language, including in our media sharing functionality. Rust is a memory safe language offering numerous security benefits. We believe that this is the largest rollout globally of any library written in Rust.

To help explain why and how we rolled this out, we should first look back at a key OS-level vulnerability that sent an important signal to WhatsApp around hardening media-sharing defenses.

2015 Android Vulnerability: A Wake-up Call for Media File Protections

In 2015, Android devices, and the applications that ran on them, became vulnerable to the "
Stagefright" vulnerability
. The bug lay in the processing of media files by operating system-provided libraries, so WhatsApp and other applications could not patch the underlying vulnerability. Because it could often take months for people to update to the latest version of their software, we set out to find solutions that would keep WhatsApp users safe, even in the event of an operating system vulnerability.

At that time, we realized that a cross-platform C++ library already developed by WhatsApp to send and consistently format MP4 files (called "wamedia") could be modified to detect files which do not adhere to the MP4 standard and might trigger bugs in a vulnerable OS library on the receiver side – hence putting a target's security at risk. We rolled out this check and were able to protect WhatsApp users from the Stagefright vulnerability much more rapidly than by depending on users to update the OS itself.

But because media checks run automatically on download and process untrusted inputs, we identified early on that wamedia was a prime candidate for using a memory safe language.

Our Solution: Rust at Scale

Rather than an incremental rewrite, we developed the Rust version of wamedia in parallel with the original C++ version. We used differential fuzzing and extensive integration and unit tests to ensure compatibility between the two implementations.

Two major hurdles were the initial binary size increase due to bringing in the Rust standard library and the build system support required for the diverse platforms supported by WhatsApp. WhatsApp made a long-term bet to build that support. In the end, we replaced 160,000 lines of C++ (excluding tests) with 90,000 lines of Rust (including tests). The Rust version showed performance and runtime memory usage advantages over the C++. Given this success, Rust was fully rolled out to all WhatsApp users and many platforms: Android, iOS, Mac, Web, Wearables, and more. With this positive evidence in hand, memory safe languages will play an ever increasing part in WhatsApp's overall approach to application and user security.

Over time, we've added more checks for non-conformant structures within certain file types to help protect downstream libraries from parser differential exploit attempts. Additionally, we check higher risk file types, even if structurally conformant, for risk indicators. For instance, PDFs are often a vehicle for malware, and more specifically, the presence of embedded files and scripting elements within a PDF further raise risks. We also detect when one file type masquerades as another, through a spoofed extension or MIME type. Finally, we uniformly flag known dangerous file types, such as executables or applications, for special handling in the application UX. Altogether, we call this ensemble of checks "Kaleidoscope." This system protects people on WhatsApp from potentially malicious unofficial clients and attachments. Although format checks will not stop every attack, this layer of defense helps mitigate many of them.

Each month, these libraries are distributed to billions of phones, laptops, desktops, watches, and browsers running on multiple operating systems for people on WhatsApp, Messenger, and Instagram. This is the largest ever deployment of Rust code to a diverse set of end-user platforms and products that we are aware of. Our experience speaks to the production-readiness and unique value proposition of Rust on the client-side.

How Rust Fits In To WhatsApp's Approach to App Security

This is just one example of WhatsApp's many investments in security. It's why we built default end-to-end encryption for personal messages and calls, offer
end-to-end encrypted
 backups, and use
key transparency technology
 to verify a secure connection, provide additional
calling protections
, and more.

WhatsApp has a strong track record of being loud when we find issues and working to hold bad actors accountable. For example, WhatsApp
reports CVEs
 for important issues we find in our applications, even if we do not find evidence of exploitation. We do this to give people on WhatsApp the best chance of protecting themselves by seeing a security advisory and updating quickly.

To ensure application security, we first must identify and quantify the sources of risk. We do this through internal and external audits like
NCC Group's public assessment
 of WhatsApp's end-to-end encrypted backups, fuzzing,
static analysis
, supply chain management, and automated attack surface analysis. We also recently expanded our
Bug Bounty program
 to introduce the
WhatsApp Research Proxy
 – a tool that makes research into WhatsApp's network protocol more effective.

Next, we reduce the identified risk. Like many others in the industry, we found that the majority of the high severity vulnerabilities we published were due to memory safety issues in code written in the C and C++ programming languages. To combat this we invest in three parallel strategies:

Design the product to minimize unnecessary attack surface exposure.

Invest in security assurance for the remaining C and C++ code.

Default the choice of memory safe languages, and not C and C++, for new code.

WhatsApp has added protections like CFI, hardened memory allocators, safer buffer handling APIs, and more. C and C++ developers have specialized security training, development guidelines, and automated security analysis on their changes. We also have strict SLAs for fixing issues uncovered by the risk identification process.

Accelerating Rust Adoption to Enhance Security

Rust enabled WhatsApp's security team to develop a secure, high performance, cross-platform library to ensure media shared on the platform is consistent and safe across devices. This is an important step forward in adding additional security behind the scenes for users and part of our ongoing defense-in-depth approach. Security teams at WhatsApp and Meta are highlighting opportunities for high impact adoption of Rust to interested teams, and we anticipate accelerating adoption of Rust over the coming years.

Share this:

Click to share on Facebook (Opens in new window)
Facebook

Click to share on Threads (Opens in new window)
Threads

Click to share on WhatsApp (Opens in new window)
WhatsApp

Click to share on LinkedIn (Opens in new window)
LinkedIn

Click to share on Reddit (Opens in new window)
Reddit

Click to share on X (Opens in new window)
X

Click to share on Bluesky (Opens in new window)
Bluesky

Click to share on Mastodon (Opens in new window)
Mastodon

Click to share on Hacker News (Opens in new window)
Hacker News

Click to email a link to a friend (Opens in new window)
Email

TAGS:
WhatsApp

Read More in Security & Privacy

View All

DEC 15, 2025

How AI Is Transforming the Adoption of Secure-by-Default Mobile Frameworks

NOV 20, 2025

Key Transparency Comes to Messenger

OCT 23, 2025

Scaling Privacy Infrastructure for GenAI Product Innovation

SEP 30, 2025

LLMs Are the Key to Mutation Testing and Better Compliance

AUG 11, 2025

Federation Platform and Privacy Waves: How Meta distributes compliance-related tasks at scale

JUL 23, 2025

Policy Zones: How Meta enforces purpose limitation at scale in batch processing systems